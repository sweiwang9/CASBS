<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Reunion Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        #map { height: 100vh; width: 100%; }
        .form-overlay { display: none; }
    </style>
</head>
<body class="bg-slate-50">

    <div id="login-screen" class="fixed inset-0 bg-slate-900 z-[2000] flex items-center justify-center text-white">
        <div class="text-center p-8 bg-slate-800 rounded-lg shadow-xl border border-slate-700">
            <h1 class="text-2xl font-serif mb-4">Academic Group Portal</h1>
            <input type="password" id="common-pass" placeholder="Enter Group Password" class="p-2 rounded bg-slate-700 mb-4 block w-full outline-none focus:ring-2 ring-blue-500">
            <button onclick="checkLogin()" class="bg-blue-600 px-6 py-2 rounded hover:bg-blue-500 transition">Access Map</button>
        </div>
    </div>

    <div id="map"></div>

    <button onclick="toggleForm()" class="fixed bottom-8 right-8 z-[1000] bg-indigo-700 text-white p-4 rounded-full shadow-2xl hover:scale-110 transition-transform font-bold">
        + Drop a Pin
    </button>

    <div id="upload-panel" class="form-overlay fixed top-0 right-0 h-full w-80 bg-white z-[1001] shadow-2xl p-6 overflow-y-auto border-l border-slate-200">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold text-slate-800">New Reunion</h2>
            <button onclick="toggleForm()" class="text-slate-400 hover:text-slate-600">✕</button>
        </div>
        
        <form id="reunion-form" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-slate-700">City/Location *</label>
                <input type="text" id="loc" required placeholder="e.g. Cambridge, UK" class="w-full border p-2 rounded mt-1">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-700">Photo (Optional)</label>
                <input type="file" accept="image/*" class="w-full text-sm mt-1">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-700">Who was there?</label>
                <textarea id="attendees" placeholder="Names of academics..." class="w-full border p-2 rounded mt-1"></textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-700">Date</label>
                <input type="date" id="date" class="w-full border p-2 rounded mt-1">
            </div>
            <button type="submit" class="w-full bg-emerald-600 text-white py-2 rounded font-semibold hover:bg-emerald-700 transition">
                Save to Map
            </button>
        </form>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize Map
        const map = L.map('map').setView([20, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Simple Login Check
        function checkLogin() {
            const pass = document.getElementById('common-pass').value;
            if(pass === "reunion2024") { // Replace with your group password
                document.getElementById('login-screen').style.display = 'none';
            } else {
                alert("Incorrect Password");
            }
        }

        // Toggle Form
        function toggleForm() {
            const panel = document.getElementById('upload-panel');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        }

        // Handle Map Clicks to set Location
        map.on('click', function(e) {
            if (document.getElementById('upload-panel').style.display === 'block') {
                const { lat, lng } = e.latlng;
                L.marker([lat, lng]).addTo(map)
                    .bindPopup("New Reunion Spot Selected")
                    .openPopup();
                document.getElementById('loc').value = `${lat.toFixed(3)}, ${lng.toFixed(3)}`;
            }
        });
    </script>
</body>
</html>
